<!DOCTYPE HTML>
<title>Backbone.Ext</title>
<script src="../vendor/jquery.js"></script>
<script src="../vendor/underscore.js"></script>
<script src="../vendor/backbone.js"></script>
<script src="../backbone.ext.js"></script>
<script>
var ListItem = Backbone.Ext.View.extend({
  tagName: 'li',
  events: {
    'click a': 'onClickLink',
  },
 
  render: function () {
    this.$el.html('Here is a <a href="#hello">link</a> in ' + this.cid);
    return this;
  },

  onClickLink: function (e) {
    alert('Hello from ' + this.cid);
    return false;
  }
});

var List = Backbone.Ext.CompositeView.extend({
  initialize: function () {
    for (var i = 0; i < 20; i++) {
      // Register the child with a selector to trigger delegation.
      // It would work the same without it, but all the event handlers would
      // be attached to each individual list element.
      this.registerChild(new ListItem, {selector: 'li'});
    }
  },

  render: function () {
    var html = '<h1>Composite View</h1><ul>';
    html += _.map(this.children, function (view) {
      // Write out a placeholder tag for each child. This element will be
      // swapped with the real view later.
      return '<view data-cid="' + view.render().cid + '" />';
    }).join('');
    html += '</ul>';

    this.$el.html(html);
    this.placeChildren();

    return this;
  }
});

var list = new List();

$(function () {
  $('body').append(list.render().el);
});
</script>
